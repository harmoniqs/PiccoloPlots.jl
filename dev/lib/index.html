<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Library · PiccoloPlots.jl</title><meta name="title" content="Library · PiccoloPlots.jl"/><meta property="og:title" content="Library · PiccoloPlots.jl"/><meta property="twitter:title" content="Library · PiccoloPlots.jl"/><meta name="description" content="Documentation for PiccoloPlots.jl."/><meta property="og:description" content="Documentation for PiccoloPlots.jl."/><meta property="twitter:description" content="Documentation for PiccoloPlots.jl."/><meta property="og:url" content="https://docs.harmoniqs.co/PiccoloPlots.jl/lib/"/><meta property="twitter:url" content="https://docs.harmoniqs.co/PiccoloPlots.jl/lib/"/><link rel="canonical" href="https://docs.harmoniqs.co/PiccoloPlots.jl/lib/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="PiccoloPlots.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PiccoloPlots.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../generated/quickstart/">Quickstart Guide</a></li><li class="is-active"><a class="tocitem" href>Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Library</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Library</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/harmoniqs/PiccoloPlots.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/harmoniqs/PiccoloPlots.jl/blob/main/docs/src/lib.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Library"><a class="docs-heading-anchor" href="#Library">Library</a><a id="Library-1"></a><a class="docs-heading-anchor-permalink" href="#Library" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PiccoloPlots.QuantumObjectPlots.plot_state_populations-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory}" href="#PiccoloPlots.QuantumObjectPlots.plot_state_populations-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>PiccoloPlots.QuantumObjectPlots.plot_state_populations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_state_populations(
    traj::NamedTrajectory;
    state_name::Symbol=:ψ̃,
    state_indices::Union{Nothing, AbstractVector{Int}}=nothing,
    control_name::Symbol=:u,
    subspace::Union{Nothing, AbstractVector{Int}}=nothing,
    kwargs...
)</code></pre><p>Plot populations for multiple quantum states stored in a trajectory.</p><p>This function visualizes the time evolution of quantum state populations for trajectories containing multiple state trajectories (e.g., from sampling problems where multiple initial states are evolved). States are identified by a common prefix and numeric suffix pattern (e.g., <code>:ψ̃1_system_1</code>, <code>:ψ̃2_system_1</code>, etc.).</p><p><strong>Mathematical Background</strong></p><p>For a quantum state <span>$|\psi(t)\rangle \in \mathcal{H}$</span> evolving under the Schrödinger equation, the population in computational basis state <span>$|i\rangle$</span> is given by</p><p class="math-container">\[P_i(t) = |\langle i|\psi(t)\rangle|^2 = |\psi_i(t)|^2\]</p><p>where <span>$\psi_i(t)$</span> is the <span>$i$</span>-th component of the state vector in the computational basis.</p><p>For a normalized state, we have the conservation property:</p><p class="math-container">\[\sum_{i=1}^{n} P_i(t) = \langle\psi(t)|\psi(t)\rangle = 1\]</p><p>When multiple states are being optimized simultaneously (as in sampling problems), this function plots the populations for each state, allowing comparison of how different initial conditions evolve under the same control protocol.</p><p><strong>Key Properties:</strong></p><ul><li>Populations are real and bounded: <span>$P_i(t) \in [0,1]$</span></li><li>Total probability is conserved: <span>$\sum_i P_i(t) = 1$</span></li><li>Can optionally restrict to a subspace (e.g., computational subspace excluding leakage states)</li></ul><p><strong>Arguments</strong></p><ul><li><code>traj::NamedTrajectory</code>: A trajectory containing one or more quantum states in isomorphism representation.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>state_name::Symbol</code>: The base name for state components. The function will find all trajectory components matching this prefix (e.g., <code>:ψ̃</code> matches <code>:ψ̃1_system_1</code>, <code>:ψ̃2_system_1</code>, etc.). Default is <code>:ψ̃</code>.</li><li><code>state_indices::Union{Nothing, AbstractVector{Int}}</code>: If provided, only plot states with these indices (e.g., <code>[1, 3]</code> plots only the 1st and 3rd states). If <code>nothing</code>, plots all states matching the prefix. Default is <code>nothing</code>.</li><li><code>control_name::Symbol</code>: The name of the control signal component to include in the plot. Default is <code>:u</code>.</li><li><code>subspace::Union{Nothing, AbstractVector{Int}}</code>: If provided, only plot populations for these basis states (e.g., <code>1:2</code> for a qubit subspace). Useful for excluding leakage levels. Default is <code>nothing</code> (plot all levels).</li><li><code>kwargs...</code>: Additional keyword arguments passed to <a href="https://docs.harmoniqs.co/NamedTrajectories/dev/generated/plotting/"><code>NamedTrajectories.plot</code></a>.</li></ul><p><strong>Returns</strong></p><ul><li>A Makie <code>Figure</code> object containing the population plots for all selected states.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using NamedTrajectories
using PiccoloQuantumObjects
using PiccoloPlots

# Example: Two initial states evolving under the same controls
N = 100
Δt = 0.1

# Initial states
ψ1_init = ComplexF64[1, 0, 0]  # |0⟩
ψ2_init = ComplexF64[0, 1, 0]  # |1⟩

# Create trajectory with multiple states
traj = NamedTrajectory(
    (
        ψ̃1_system_1 = hcat([ket_to_iso(ψ1_init) for _ in 1:N]...),
        ψ̃2_system_1 = hcat([ket_to_iso(ψ2_init) for _ in 1:N]...),
        u = randn(2, N),
        Δt = fill(Δt, N),
    );
    controls = :u,
    timestep = :Δt,
)

# Plot populations for all states
plot_state_populations(traj)

# Plot only computational subspace (excluding 3rd level)
plot_state_populations(traj; subspace=1:2)

# Plot only first state
plot_state_populations(traj; state_indices=[1])</code></pre><p>See also: <a href="#PiccoloPlots.QuantumObjectPlots.plot_unitary_populations-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>plot_unitary_populations</code></a>, <a href="https://docs.harmoniqs.co/NamedTrajectories/dev/generated/plotting/"><code>NamedTrajectories.plot</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/harmoniqs/PiccoloPlots.jl/blob/037f5ecc585f4c2196829adcff7f8aaa0f9c9051/src/quantum_object_plots/state_populations.jl#L1-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PiccoloPlots.QuantumObjectPlots.plot_unitary_populations-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory}" href="#PiccoloPlots.QuantumObjectPlots.plot_unitary_populations-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>PiccoloPlots.QuantumObjectPlots.plot_unitary_populations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_unitary_populations(
    traj::NamedTrajectory;
    unitary_columns::AbstractVector{Int}=1:2,
    unitary_name::Symbol=:Ũ⃗,
    control_name::Symbol=:u,
    kwargs...
)</code></pre><p>Plot the state populations for specified columns of a unitary operator trajectory.</p><p>This function visualizes how the populations (squared magnitudes) of quantum states evolve over time for selected columns of a unitary matrix stored in a <code>NamedTrajectory</code>.</p><p><strong>Mathematical Background</strong></p><p>For a unitary operator <span>$U(t) \in \mathcal{U}(n)$</span> evolving under a time-dependent Hamiltonian, this function plots the populations</p><p class="math-container">\[P_{i,j}(t) = |U_{i,j}(t)|^2\]</p><p>where <span>$U_{i,j}(t)$</span> is the <span>$(i,j)$</span>-th element of the unitary matrix at time <span>$t$</span>.</p><p>For a quantum system evolving according to the Schrödinger equation</p><p class="math-container">\[\frac{d}{dt}U(t) = -iH(t)U(t), \quad U(0) = I\]</p><p>each column <span>$j$</span> of <span>$U(t)$</span> represents the time evolution of the initial basis state <span>$|j\rangle$</span>:</p><p class="math-container">\[|\psi_j(t)\rangle = U(t)|j\rangle = \sum_{i=1}^{n} U_{i,j}(t)|i\rangle\]</p><p>The population <span>$P_{i,j}(t) = |U_{i,j}(t)|^2$</span> gives the probability of finding the system in state <span>$|i\rangle$</span> at time <span>$t$</span> given that it started in state <span>$|j\rangle$</span>.</p><p><strong>Key Properties:</strong></p><ul><li>Unitarity ensures <span>$\sum_{i=1}^{n} P_{i,j}(t) = 1$</span> for all <span>$j$</span> and <span>$t$</span> (probability conservation)</li><li><span>$P_{i,j}(0) = \delta_{ij}$</span> (initially in definite state)</li><li>Populations are real and bounded: <span>$P_{i,j}(t) \in [0,1]$</span></li></ul><p>The trajectory stores <span>$U(t)$</span> in isomorphism representation <span>$\tilde{U}(t)$</span>, a vectorized form that preserves the operator structure while enabling efficient optimization algorithms.</p><p><strong>Arguments</strong></p><ul><li><code>traj::NamedTrajectory</code>: A trajectory containing a unitary operator in isomorphism representation.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>unitary_columns::AbstractVector{Int}</code>: Indices of unitary matrix columns to plot. Each column <span>$j$</span> corresponds to the evolution of basis state <span>$|j\rangle$</span>. Default is <code>1:2</code>.</li><li><code>unitary_name::Symbol</code>: The name of the unitary operator component in the trajectory, stored as an isomorphism vector (<span>$\tilde{U}$</span>). Default is <code>:Ũ⃗</code>.</li><li><code>control_name::Symbol</code>: The name of the control signal component to include in the plot, typically the time-dependent control parameters <span>$u(t)$</span> in <span>$H(t) = H_0 + \sum_k u_k(t) H_k$</span>. Default is <code>:u</code>.</li><li><code>kwargs...</code>: Additional keyword arguments passed to <a href="https://docs.harmoniqs.co/NamedTrajectories/dev/generated/plotting/"><code>NamedTrajectories.plot</code></a>, such as <code>xlims</code>, <code>ylims</code>, or Makie-specific plotting options.</li></ul><p><strong>Returns</strong></p><ul><li>A Makie <code>Figure</code> object containing the population plots.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using NamedTrajectories
using PiccoloQuantumObjects
using PiccoloPlots

# Define Hamiltonian: H = X + a₁(t)Z + a₂(t)Y
H_drift = PAULIS[:X]
H_drives = [PAULIS[:Z], PAULIS[:Y]]

# Generate control trajectory
N = 100
Δt = 0.1
ts = collect(0:Δt:Δt*(N-1))
u = 0.1 * randn(2, length(ts))

# Generate unitaries
Us = exp.(-im * [(H_drift + sum(u[:, k] .* H_drives)) * ts[k] for k = 1:N])

# Create trajectory
traj = NamedTrajectory(
    (
        Ũ⃗ = hcat(operator_to_iso_vec.(Us)...),
        u = u,
        Δt = ts,
    );
    controls = :u,
    timestep = :Δt,
)

# Plot populations for first two columns
plot_unitary_populations(traj)

# Plot only the first column
plot_unitary_populations(traj; unitary_columns=[1])</code></pre><p>See also: <a href="https://docs.harmoniqs.co/NamedTrajectories/dev/generated/plotting/"><code>NamedTrajectories.plot</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/harmoniqs/PiccoloPlots.jl/blob/037f5ecc585f4c2196829adcff7f8aaa0f9c9051/src/quantum_object_plots/unitary_populations.jl#L1-L104">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../generated/quickstart/">« Quickstart Guide</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 29 October 2025 04:49">Wednesday 29 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
